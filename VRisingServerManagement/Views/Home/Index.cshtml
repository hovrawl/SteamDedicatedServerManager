@{
    ViewData["Title"] = "V Rising Server Manager";
}

<div class="text-center">
    <h1 class="display-4">V Rising Server Manager</h1>
    <p>Cards that will link to Each page; Settings, Console</p>
    <button class="h-download-btn" type="button">Download V Rising Server</button>
    
    <textarea class="h-download-console">
        
    </textarea>
</div>


<script type="text/javascript">   
    function downloadVRisingServer(){
        fetch('@Url.Action("DownloadVRisingServer")', {
            method: 'POST'
        })
            .then((response) => {
                if (response.ok){
    
                }
    
            })
            .then((data) => console.log(data))
    }
    $(document).ready(function (){
        // on start function
        let downloadBtn = $('.h-download-btn');
        downloadBtn.on('click', downloadVRisingServer);
    
        let downloadConsole = $('.h-download-console');
        let source = new EventSource('@Url.Action("DownloadConsoleMessage")');
        //let source = new EventSource('/console-sse');
        source.onopen = function (){
            downloadConsole.append('Connected');
        }
        source.onerror = function (event){
            source.close();
        }
        source.onmessage = function (event){
            if (event.data){
                downloadConsole.append(event.data);
            }
        }
    });
    
</script>